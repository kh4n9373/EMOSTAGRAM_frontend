{"ast":null,"code":"var _jsxFileName = \"/Users/khangtuan/Documents/eq_test/eq_test_frontend_v2/src/views/page-chat.js\",\n  _s = $RefreshSig$(),\n  _s2 = $RefreshSig$();\nimport React, { useEffect, useRef, useState } from 'react';\nimport { Helmet } from 'react-helmet';\nimport { jsxDEV as _jsxDEV, Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nconst IconPaperclip = props => /*#__PURE__*/_jsxDEV(\"svg\", {\n  width: \"20\",\n  height: \"20\",\n  viewBox: \"0 0 24 24\",\n  fill: \"none\",\n  stroke: \"currentColor\",\n  strokeWidth: \"1.7\",\n  ...props,\n  children: /*#__PURE__*/_jsxDEV(\"path\", {\n    d: \"M21 11L10 22a5 5 0 0 1-7-7l11-11a3 3 0 0 1 4 4L8 19a1.5 1.5 0 0 1-2-2l9-9\",\n    strokeLinecap: \"round\",\n    strokeLinejoin: \"round\"\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 6,\n    columnNumber: 5\n  }, this)\n}, void 0, false, {\n  fileName: _jsxFileName,\n  lineNumber: 5,\n  columnNumber: 3\n}, this);\n_c = IconPaperclip;\nconst IconMic = props => /*#__PURE__*/_jsxDEV(\"svg\", {\n  width: \"18\",\n  height: \"18\",\n  viewBox: \"0 0 24 24\",\n  fill: \"none\",\n  stroke: \"currentColor\",\n  strokeWidth: \"1.8\",\n  ...props,\n  children: [/*#__PURE__*/_jsxDEV(\"rect\", {\n    x: \"9\",\n    y: \"2\",\n    width: \"6\",\n    height: \"12\",\n    rx: \"3\"\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 12,\n    columnNumber: 5\n  }, this), /*#__PURE__*/_jsxDEV(\"path\", {\n    d: \"M5 11a7 7 0 0 0 14 0\"\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 13,\n    columnNumber: 5\n  }, this), /*#__PURE__*/_jsxDEV(\"path\", {\n    d: \"M12 19v3\"\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 14,\n    columnNumber: 5\n  }, this)]\n}, void 0, true, {\n  fileName: _jsxFileName,\n  lineNumber: 11,\n  columnNumber: 3\n}, this);\n/* ==== Icons & button style ==== */\n_c2 = IconMic;\nconst IconCopy = props => /*#__PURE__*/_jsxDEV(\"svg\", {\n  width: \"18\",\n  height: \"18\",\n  viewBox: \"0 0 24 24\",\n  fill: \"none\",\n  ...props,\n  children: [/*#__PURE__*/_jsxDEV(\"rect\", {\n    x: \"9\",\n    y: \"9\",\n    width: \"11\",\n    height: \"11\",\n    rx: \"2\",\n    stroke: \"currentColor\",\n    strokeWidth: \"1.7\"\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 20,\n    columnNumber: 5\n  }, this), /*#__PURE__*/_jsxDEV(\"rect\", {\n    x: \"4\",\n    y: \"4\",\n    width: \"11\",\n    height: \"11\",\n    rx: \"2\",\n    stroke: \"currentColor\",\n    strokeWidth: \"1.7\"\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 21,\n    columnNumber: 5\n  }, this)]\n}, void 0, true, {\n  fileName: _jsxFileName,\n  lineNumber: 19,\n  columnNumber: 3\n}, this);\n_c3 = IconCopy;\nconst IconThumbUp = props => /*#__PURE__*/_jsxDEV(\"svg\", {\n  width: \"18\",\n  height: \"18\",\n  viewBox: \"0 0 24 24\",\n  fill: \"none\",\n  ...props,\n  children: /*#__PURE__*/_jsxDEV(\"path\", {\n    d: \"M14 10V5a2 2 0 0 0-2-2l-3 7H5a2 2 0 0 0-2 2v7h10.3a3 3 0 0 0 2.9-2.1l2.1-6.2A2 2 0 0 0 16.4 9H14z\",\n    stroke: \"currentColor\",\n    strokeWidth: \"1.7\",\n    strokeLinejoin: \"round\"\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 27,\n    columnNumber: 5\n  }, this)\n}, void 0, false, {\n  fileName: _jsxFileName,\n  lineNumber: 26,\n  columnNumber: 3\n}, this);\n_c4 = IconThumbUp;\nconst IconThumbDown = props => /*#__PURE__*/_jsxDEV(\"svg\", {\n  width: \"18\",\n  height: \"18\",\n  viewBox: \"0 0 24 24\",\n  fill: \"none\",\n  ...props,\n  children: /*#__PURE__*/_jsxDEV(\"path\", {\n    d: \"M10 14v5a2 2 0 0 0 2 2l3-7h4a2 2 0 0 0 2-2V5H10.7a3 3 0 0 0-2.9 2.1L5.7 13.3A2 2 0 0 0 7.6 16H10z\",\n    stroke: \"currentColor\",\n    strokeWidth: \"1.7\",\n    strokeLinejoin: \"round\"\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 33,\n    columnNumber: 5\n  }, this)\n}, void 0, false, {\n  fileName: _jsxFileName,\n  lineNumber: 32,\n  columnNumber: 3\n}, this);\n\n/*  active: nền đen, chữ trắng, border đen  */\n_c5 = IconThumbDown;\nconst actionBtnStyle = (active = false) => ({\n  background: active ? '#111827' : '#fff',\n  border: `1px solid ${active ? '#111827' : '#e5e7eb'}`,\n  color: active ? '#ffffff' : '#6b7280',\n  padding: '6px 10px',\n  borderRadius: 10,\n  display: 'inline-flex',\n  alignItems: 'center',\n  gap: 6,\n  cursor: 'pointer',\n  boxShadow: active ? '0 2px 10px rgba(0,0,0,0.15)' : '0 1px 4px rgba(0,0,0,0.04)',\n  userSelect: 'none',\n  transition: 'all .15s ease'\n});\n\n/* ==== Avatar ==== */\nconst Avatar = () => /*#__PURE__*/_jsxDEV(\"div\", {\n  style: {\n    width: 64,\n    height: 64,\n    borderRadius: 12,\n    background: '#e5e7eb',\n    display: 'grid',\n    placeItems: 'center'\n  },\n  children: /*#__PURE__*/_jsxDEV(\"span\", {\n    style: {\n      fontWeight: 700\n    },\n    children: \"E\"\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 56,\n    columnNumber: 5\n  }, this)\n}, void 0, false, {\n  fileName: _jsxFileName,\n  lineNumber: 55,\n  columnNumber: 3\n}, this);\n\n/* ==== Message Bubble ==== */\n_c6 = Avatar;\nconst MessageBubble = ({\n  role,\n  children,\n  media\n}) => {\n  const isUser = role === 'user';\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    style: {\n      display: 'grid',\n      justifyItems: isUser ? 'end' : 'start'\n    },\n    children: /*#__PURE__*/_jsxDEV(\"div\", {\n      style: {\n        maxWidth: 720,\n        background: isUser ? '#111827' : '#ffffff',\n        color: isUser ? 'white' : '#111827',\n        border: isUser ? 'none' : '1px solid #e5e7eb',\n        padding: media ? 8 : 12,\n        borderRadius: 16,\n        boxShadow: isUser ? '0 4px 14px rgba(0,0,0,0.15)' : '0 4px 14px rgba(0,0,0,0.06)',\n        display: 'inline-block',\n        width: 'fit-content',\n        lineHeight: 1.6\n      },\n      children: media ? /*#__PURE__*/_jsxDEV(\"img\", {\n        src: media,\n        alt: \"attachment\",\n        style: {\n          width: 260,\n          borderRadius: 12\n        }\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 78,\n        columnNumber: 11\n      }, this) : /*#__PURE__*/_jsxDEV(\"div\", {\n        style: {\n          whiteSpace: 'pre-wrap'\n        },\n        children: children\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 80,\n        columnNumber: 11\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 65,\n      columnNumber: 7\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 64,\n    columnNumber: 5\n  }, this);\n};\n// Đặt trên cùng file, trước ChatPage\n_c7 = MessageBubble;\nconst AutoTextarea = /*#__PURE__*/_s(/*#__PURE__*/React.forwardRef(_c8 = _s(function AutoTextarea({\n  value,\n  onChange,\n  onSend,\n  // gọi khi Enter (không kèm Ctrl/Cmd)\n  placeholder,\n  style\n}, ref) {\n  _s();\n  const localRef = useRef(null);\n  const textareaRef = ref || localRef;\n  const autoSize = () => {\n    const el = textareaRef.current;\n    if (!el) return;\n    el.style.height = 'auto';\n    // Giới hạn chiều cao tối đa để không chiếm màn hình\n    const max = 240; // px (tuỳ bạn)\n    const h = Math.min(el.scrollHeight, max);\n    el.style.height = h + 'px';\n    el.style.overflowY = el.scrollHeight > max ? 'auto' : 'hidden';\n  };\n  useEffect(() => {\n    autoSize();\n  }, [value]);\n  const onKeyDown = e => {\n    if (e.key === 'Enter') {\n      if (e.metaKey || e.ctrlKey) {\n        // chèn \\n tại caret và không gửi\n        e.preventDefault();\n        const el = textareaRef.current;\n        if (!el) return;\n        const start = el.selectionStart;\n        const end = el.selectionEnd;\n        const next = value.slice(0, start) + '\\n' + value.slice(end);\n        onChange({\n          target: {\n            value: next\n          }\n        });\n        // đặt lại caret sau \\n\n        requestAnimationFrame(() => {\n          el.selectionStart = el.selectionEnd = start + 1;\n          autoSize();\n        });\n      } else {\n        // Enter thường => gửi\n        e.preventDefault();\n        onSend === null || onSend === void 0 ? void 0 : onSend();\n      }\n    }\n  };\n  return /*#__PURE__*/_jsxDEV(\"textarea\", {\n    ref: textareaRef,\n    value: value,\n    onChange: e => {\n      onChange(e); /* autosize lúc gõ */\n      requestAnimationFrame(autoSize);\n    },\n    onKeyDown: onKeyDown,\n    placeholder: placeholder,\n    rows: 1,\n    style: {\n      flex: 1,\n      background: 'transparent',\n      color: '#111827',\n      border: 'none',\n      outline: 'none',\n      padding: '12px 10px',\n      fontSize: 18,\n      lineHeight: 1.6,\n      resize: 'none',\n      overflow: 'hidden',\n      whiteSpace: 'pre-wrap',\n      wordBreak: 'break-word',\n      ...style\n    },\n    \"aria-label\": \"Message input\"\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 138,\n    columnNumber: 5\n  }, this);\n}, \"28K6HmXVpFGf/iqhT8LTjwTKC6E=\")), \"28K6HmXVpFGf/iqhT8LTjwTKC6E=\");\n\n/* ==== Small toast ==== */\n_c9 = AutoTextarea;\nconst Toast = ({\n  show,\n  children\n}) => /*#__PURE__*/_jsxDEV(\"div\", {\n  \"aria-live\": \"polite\",\n  style: {\n    position: 'absolute',\n    top: -100,\n    left: '50%',\n    transform: 'translateX(-50%)',\n    opacity: show ? 1 : 0,\n    transition: 'opacity .2s ease',\n    pointerEvents: 'none'\n  },\n  children: /*#__PURE__*/_jsxDEV(\"div\", {\n    style: {\n      background: '#111827',\n      color: 'white',\n      padding: '6px 10px',\n      borderRadius: 999,\n      fontSize: 12,\n      boxShadow: '0 6px 18px rgba(0,0,0,.18)'\n    },\n    children: children\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 179,\n    columnNumber: 5\n  }, this)\n}, void 0, false, {\n  fileName: _jsxFileName,\n  lineNumber: 167,\n  columnNumber: 3\n}, this);\n\n/* ==== Main Page ==== */\n_c0 = Toast;\nconst ChatPage = () => {\n  _s2();\n  const [messages, setMessages] = useState([]);\n  const [text, setText] = useState('');\n  const [mediaPreview, setMediaPreview] = useState(null);\n  const [mediaFile, setMediaFile] = useState(null);\n  const [recording, setRecording] = useState(false);\n  const listRef = useRef(null);\n  const bottomRef = useRef(null);\n  const barRef = useRef(null); // wrapper fixed\n  const barInnerRef = useRef(null); // inner box được đo bằng ResizeObserver\n  const [bottomPad, setBottomPad] = useState(96);\n\n  // ratings & copy states\n  const [ratings, setRatings] = useState({});\n  const [copiedId, setCopiedId] = useState(null);\n\n  // Auto scroll khi có tin nhắn mới hoặc khi padding đáy thay đổi\n  useEffect(() => {\n    if (!barRef.current) return;\n    const update = () => {\n      var _barRef$current$offse, _barRef$current;\n      const h = (_barRef$current$offse = (_barRef$current = barRef.current) === null || _barRef$current === void 0 ? void 0 : _barRef$current.offsetHeight) !== null && _barRef$current$offse !== void 0 ? _barRef$current$offse : 0;\n      setBottomPad(h + 16); // +16px breathing\n    };\n\n    // đo động khi bar thay đổi kích thước\n    const ro = new ResizeObserver(update);\n    ro.observe(barRef.current);\n\n    // nghe luôn sự kiện resize (desktop)\n    window.addEventListener('resize', update);\n    update();\n    return () => {\n      ro.disconnect();\n      window.removeEventListener('resize', update);\n    };\n  }, []);\n\n  // Đo chiều cao thực của thanh input (kể cả margin) + safe-area\n  useEffect(() => {\n    const el = barInnerRef.current;\n    if (!el) return;\n    const compute = () => {\n      const rect = el.getBoundingClientRect();\n      const cs = window.getComputedStyle(el);\n      const margin = parseFloat(cs.marginTop) + parseFloat(cs.marginBottom);\n      const safe = Number(getComputedStyle(document.documentElement).getPropertyValue('--sat-safe-area-bottom') || 0);\n      setBottomPad(rect.height + margin + 8 + safe);\n    };\n\n    // fall back: đọc env(safe-area-inset-bottom) qua CSS var\n    const updateCSSVar = () => {\n      const div = document.createElement('div');\n      div.style.cssText = 'position:fixed;bottom:0;left:0;right:0;padding-bottom:env(safe-area-inset-bottom);visibility:hidden;';\n      document.body.appendChild(div);\n      const pb = parseFloat(getComputedStyle(div).paddingBottom) || 0;\n      document.documentElement.style.setProperty('--sat-safe-area-bottom', pb);\n      document.body.removeChild(div);\n    };\n    updateCSSVar();\n    compute();\n    const ro = new ResizeObserver(compute);\n    ro.observe(el);\n    window.addEventListener('resize', compute);\n    return () => {\n      ro.disconnect();\n      window.removeEventListener('resize', compute);\n    };\n  }, []);\n  const handleRate = (id, val) => {\n    setRatings(prev => ({\n      ...prev,\n      [id]: prev[id] === val ? undefined : val\n    }));\n  };\n  const handleCopy = async (id, text) => {\n    if (!text) return;\n    try {\n      await navigator.clipboard.writeText(text);\n      setCopiedId(id);\n      setTimeout(() => setCopiedId(null), 1200);\n    } catch {}\n  };\n  const sendMessage = async () => {\n    if (!text && !mediaPreview) return;\n    const now = Date.now();\n    const newMsgs = [];\n    if (mediaPreview) newMsgs.push({\n      id: now,\n      role: 'user',\n      media: mediaPreview\n    });\n    if (text) newMsgs.push({\n      id: now + 1,\n      role: 'user',\n      text\n    });\n    setMessages(m => m.concat(newMsgs));\n    setText('');\n    setMediaPreview(null);\n    setMediaFile(null);\n    try {\n      var _j$data;\n      const res = await fetch('/api/v1/analysis/analyze-sentiment', {\n        method: 'POST',\n        headers: {\n          'Content-Type': 'application/json'\n        },\n        credentials: 'include',\n        body: JSON.stringify({\n          text: text || '[media]'\n        })\n      });\n      const j = await res.json();\n      const reply = j !== null && j !== void 0 && (_j$data = j.data) !== null && _j$data !== void 0 && _j$data.label ? `Chào bạn! Hình như chúng ta đã chào nhau rồi nhỉ. Bạn muốn hỏi thêm gì về Emostagram? (Sentiment: ${j.data.label})` : 'Chào bạn! Hình như chúng ta đã chào nhau rồi nhỉ. Bạn muốn hỏi thêm gì về Emostagram?';\n      setMessages(m => m.concat({\n        id: Date.now() + 2,\n        role: 'assistant',\n        text: reply\n      }));\n    } catch {\n      setMessages(m => m.concat({\n        id: Date.now() + 2,\n        role: 'assistant',\n        text: 'Sorry, something went wrong.'\n      }));\n    }\n  };\n\n  // Voice input\n  const startVoice = () => {\n    if (!('webkitSpeechRecognition' in window) && !('SpeechRecognition' in window)) {\n      alert('Voice input not supported in this browser');\n      return;\n    }\n    const SR = window.SpeechRecognition || window.webkitSpeechRecognition;\n    const rec = new SR();\n    rec.lang = 'vi-VN';\n    rec.interimResults = false;\n    rec.maxAlternatives = 1;\n    setRecording(true);\n    rec.onresult = e => {\n      const t = e.results[0][0].transcript;\n      setText(prev => prev ? prev + ' ' + t : t);\n    };\n    rec.onend = () => setRecording(false);\n    rec.onerror = () => setRecording(false);\n    rec.start();\n  };\n  const onPickMedia = e => {\n    var _e$target$files;\n    const f = (_e$target$files = e.target.files) === null || _e$target$files === void 0 ? void 0 : _e$target$files[0];\n    if (!f) return;\n    const url = URL.createObjectURL(f);\n    setMediaPreview(url);\n    setMediaFile(f);\n  };\n  const showHero = messages.length === 0;\n  return /*#__PURE__*/_jsxDEV(\"main\", {\n    style: {\n      minHeight: '100vh',\n      background: '#f8fafc',\n      color: '#111827'\n    },\n    children: [/*#__PURE__*/_jsxDEV(Helmet, {\n      children: /*#__PURE__*/_jsxDEV(\"title\", {\n        children: \"Chat - Emostagram\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 340,\n        columnNumber: 15\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 340,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      style: {\n        maxWidth: 980,\n        margin: '0 auto',\n        padding: '16px 16px 0 16px',\n        display: 'grid',\n        gap: 16\n      },\n      children: showHero ? /*#__PURE__*/_jsxDEV(\"div\", {\n        style: {\n          minHeight: '70vh',\n          display: 'grid',\n          alignContent: 'center',\n          justifyItems: 'center',\n          gap: 20\n        },\n        children: [/*#__PURE__*/_jsxDEV(Avatar, {}, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 344,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"h1\", {\n          style: {\n            marginTop: 8,\n            fontSize: 36,\n            fontWeight: 700\n          },\n          children: \"Emostagram\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 345,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          style: {\n            width: '100%',\n            display: 'grid',\n            justifyItems: 'center',\n            gap: 12\n          },\n          children: [mediaPreview && /*#__PURE__*/_jsxDEV(\"img\", {\n            src: mediaPreview,\n            alt: \"preview\",\n            style: {\n              width: 72,\n              height: 72,\n              objectFit: 'cover',\n              borderRadius: 14,\n              boxShadow: '0 8px 26px rgba(0,0,0,0.12)'\n            }\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 348,\n            columnNumber: 17\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            style: {\n              width: 'min(92vw, 760px)',\n              height: 64,\n              background: '#ffffff',\n              border: '1px solid #e5e7eb',\n              borderRadius: 18,\n              boxShadow: '0 12px 40px rgba(0,0,0,0.06)',\n              display: 'flex',\n              alignItems: 'center',\n              padding: '0 10px',\n              gap: 8\n            },\n            children: [/*#__PURE__*/_jsxDEV(\"label\", {\n              style: {\n                cursor: 'pointer',\n                padding: 8,\n                display: 'grid',\n                placeItems: 'center'\n              },\n              children: [\"\\uD83D\\uDCCE\", /*#__PURE__*/_jsxDEV(\"input\", {\n                accept: \"*/*\",\n                type: \"file\",\n                style: {\n                  display: 'none'\n                },\n                onChange: onPickMedia\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 364,\n                columnNumber: 19\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 362,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(AutoTextarea, {\n              value: text,\n              onChange: e => setText(e.target.value),\n              onSend: sendMessage,\n              onKeyDown: e => {\n                if (e.key === 'Enter') {\n                  if (e.shiftKey) {\n                    // xuống dòng, giữ mặc định\n                    return;\n                  } else {\n                    // gửi\n                    e.preventDefault();\n                    sendMessage();\n                  }\n                }\n              },\n              placeholder: \"What do you want to know?\",\n              style: {\n                flex: 1,\n                background: 'transparent',\n                color: '#111827',\n                border: 'none',\n                outline: 'none',\n                padding: '12px 10px',\n                fontSize: 18\n              }\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 366,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n              onClick: startVoice,\n              \"aria-label\": \"voice\",\n              style: {\n                width: 42,\n                height: 42,\n                borderRadius: 999,\n                background: '#111827',\n                color: 'white',\n                border: 'none',\n                display: 'grid',\n                placeItems: 'center'\n              },\n              children: recording ? '🎙️' : '🎤'\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 385,\n              columnNumber: 17\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 350,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 346,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 343,\n        columnNumber: 11\n      }, this) : /*#__PURE__*/_jsxDEV(_Fragment, {\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          ref: listRef,\n          style: {\n            display: 'grid',\n            gap: 6,\n            padding: '0 8px',\n            alignItems: 'start',\n            gridAutoRows: 'max-content',\n            margin: 0,\n            // paddingBottom: bottomPad\n            paddingBottom: `calc(${bottomPad}px + env(safe-area-inset-bottom, 0px))`\n          },\n          children: [messages.map(m => {\n            const rated = ratings[m.id];\n            return /*#__PURE__*/_jsxDEV(\"div\", {\n              style: {\n                display: 'grid',\n                gap: 6\n              },\n              children: [/*#__PURE__*/_jsxDEV(MessageBubble, {\n                role: m.role,\n                media: m.media,\n                children: m.text\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 412,\n                columnNumber: 21\n              }, this), m.role === 'assistant' && /*#__PURE__*/_jsxDEV(\"div\", {\n                style: {\n                  position: 'relative'\n                },\n                children: [/*#__PURE__*/_jsxDEV(Toast, {\n                  show: copiedId === m.id,\n                  children: \"Copy th\\xE0nh c\\xF4ng\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 416,\n                  columnNumber: 25\n                }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                  style: {\n                    display: 'flex',\n                    gap: 8\n                  },\n                  children: [/*#__PURE__*/_jsxDEV(\"button\", {\n                    \"aria-label\": \"copy\",\n                    onClick: () => handleCopy(m.id, m.text),\n                    style: actionBtnStyle(copiedId === m.id),\n                    children: /*#__PURE__*/_jsxDEV(IconCopy, {}, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 424,\n                      columnNumber: 29\n                    }, this)\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 419,\n                    columnNumber: 27\n                  }, this), (rated === undefined || rated === 'up') && /*#__PURE__*/_jsxDEV(\"button\", {\n                    \"aria-label\": \"like\",\n                    onClick: () => handleRate(m.id, 'up'),\n                    style: actionBtnStyle(rated === 'up'),\n                    title: \"Like\",\n                    children: /*#__PURE__*/_jsxDEV(IconThumbUp, {}, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 434,\n                      columnNumber: 31\n                    }, this)\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 428,\n                    columnNumber: 29\n                  }, this), (rated === undefined || rated === 'down') && /*#__PURE__*/_jsxDEV(\"button\", {\n                    \"aria-label\": \"dislike\",\n                    onClick: () => handleRate(m.id, 'down'),\n                    style: actionBtnStyle(rated === 'down'),\n                    title: \"Dislike\",\n                    children: /*#__PURE__*/_jsxDEV(IconThumbDown, {}, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 445,\n                      columnNumber: 31\n                    }, this)\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 439,\n                    columnNumber: 29\n                  }, this)]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 418,\n                  columnNumber: 25\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 415,\n                columnNumber: 23\n              }, this)]\n            }, m.id, true, {\n              fileName: _jsxFileName,\n              lineNumber: 411,\n              columnNumber: 19\n            }, this);\n          }), /*#__PURE__*/_jsxDEV(\"div\", {\n            ref: bottomRef,\n            style: {\n              height: 1\n            }\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 455,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 394,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          ref: barRef,\n          style: {\n            position: 'fixed',\n            left: 0,\n            right: 0,\n            bottom: 0,\n            paddingBottom: 'env(safe-area-inset-bottom)'\n          },\n          children: /*#__PURE__*/_jsxDEV(\"div\", {\n            ref: barInnerRef,\n            style: {\n              maxWidth: 980,\n              margin: '12px auto',\n              position: 'relative'\n            },\n            children: [mediaPreview && /*#__PURE__*/_jsxDEV(\"img\", {\n              src: mediaPreview,\n              alt: \"preview\",\n              style: {\n                position: 'absolute',\n                bottom: '100%',\n                left: 0,\n                width: 56,\n                height: 56,\n                objectFit: 'cover',\n                borderRadius: 12,\n                boxShadow: '0 6px 20px rgba(0,0,0,0.12)',\n                marginBottom: 8\n              }\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 478,\n              columnNumber: 19\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              style: {\n                display: 'flex',\n                alignItems: 'center',\n                gap: 8,\n                background: '#ffffff',\n                border: '1px solid #e5e7eb',\n                borderRadius: 16,\n                padding: 8\n              },\n              children: [/*#__PURE__*/_jsxDEV(\"label\", {\n                style: {\n                  cursor: 'pointer',\n                  padding: 8\n                },\n                children: [\"\\uD83D\\uDCCE\", /*#__PURE__*/_jsxDEV(\"input\", {\n                  accept: \"*/*\",\n                  type: \"file\",\n                  style: {\n                    display: 'none'\n                  },\n                  onChange: onPickMedia\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 505,\n                  columnNumber: 21\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 503,\n                columnNumber: 19\n              }, this), /*#__PURE__*/_jsxDEV(AutoTextarea, {\n                value: text,\n                onChange: e => setText(e.target.value),\n                onSend: sendMessage,\n                onKeyDown: e => {\n                  if (e.key === 'Enter') {\n                    if (e.shiftKey) {\n                      // xuống dòng, giữ mặc định\n                      return;\n                    } else {\n                      // gửi\n                      e.preventDefault();\n                      sendMessage();\n                    }\n                  }\n                },\n                placeholder: \"What do you want to know?\",\n                style: {\n                  flex: 1,\n                  background: 'transparent',\n                  color: '#111827',\n                  border: 'none',\n                  outline: 'none',\n                  padding: '12px 10px',\n                  fontSize: 18\n                }\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 507,\n                columnNumber: 19\n              }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n                onClick: startVoice,\n                \"aria-label\": \"voice\",\n                style: {\n                  width: 42,\n                  height: 42,\n                  borderRadius: 999,\n                  background: '#111827',\n                  color: 'white',\n                  border: 'none',\n                  display: 'grid',\n                  placeItems: 'center'\n                },\n                children: recording ? '🎙️' : '🎤'\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 526,\n                columnNumber: 19\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 494,\n              columnNumber: 17\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 469,\n            columnNumber: 15\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 459,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 341,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 339,\n    columnNumber: 5\n  }, this);\n};\n_s2(ChatPage, \"uhUkFe2CIrgw26JQgvmqIc2Qxxk=\");\n_c1 = ChatPage;\nexport default ChatPage;\nvar _c, _c2, _c3, _c4, _c5, _c6, _c7, _c8, _c9, _c0, _c1;\n$RefreshReg$(_c, \"IconPaperclip\");\n$RefreshReg$(_c2, \"IconMic\");\n$RefreshReg$(_c3, \"IconCopy\");\n$RefreshReg$(_c4, \"IconThumbUp\");\n$RefreshReg$(_c5, \"IconThumbDown\");\n$RefreshReg$(_c6, \"Avatar\");\n$RefreshReg$(_c7, \"MessageBubble\");\n$RefreshReg$(_c8, \"AutoTextarea$React.forwardRef\");\n$RefreshReg$(_c9, \"AutoTextarea\");\n$RefreshReg$(_c0, \"Toast\");\n$RefreshReg$(_c1, \"ChatPage\");","map":{"version":3,"names":["React","useEffect","useRef","useState","Helmet","jsxDEV","_jsxDEV","Fragment","_Fragment","IconPaperclip","props","width","height","viewBox","fill","stroke","strokeWidth","children","d","strokeLinecap","strokeLinejoin","fileName","_jsxFileName","lineNumber","columnNumber","_c","IconMic","x","y","rx","_c2","IconCopy","_c3","IconThumbUp","_c4","IconThumbDown","_c5","actionBtnStyle","active","background","border","color","padding","borderRadius","display","alignItems","gap","cursor","boxShadow","userSelect","transition","Avatar","style","placeItems","fontWeight","_c6","MessageBubble","role","media","isUser","justifyItems","maxWidth","lineHeight","src","alt","whiteSpace","_c7","AutoTextarea","_s","forwardRef","_c8","value","onChange","onSend","placeholder","ref","localRef","textareaRef","autoSize","el","current","max","h","Math","min","scrollHeight","overflowY","onKeyDown","e","key","metaKey","ctrlKey","preventDefault","start","selectionStart","end","selectionEnd","next","slice","target","requestAnimationFrame","rows","flex","outline","fontSize","resize","overflow","wordBreak","_c9","Toast","show","position","top","left","transform","opacity","pointerEvents","_c0","ChatPage","_s2","messages","setMessages","text","setText","mediaPreview","setMediaPreview","mediaFile","setMediaFile","recording","setRecording","listRef","bottomRef","barRef","barInnerRef","bottomPad","setBottomPad","ratings","setRatings","copiedId","setCopiedId","update","_barRef$current$offse","_barRef$current","offsetHeight","ro","ResizeObserver","observe","window","addEventListener","disconnect","removeEventListener","compute","rect","getBoundingClientRect","cs","getComputedStyle","margin","parseFloat","marginTop","marginBottom","safe","Number","document","documentElement","getPropertyValue","updateCSSVar","div","createElement","cssText","body","appendChild","pb","paddingBottom","setProperty","removeChild","handleRate","id","val","prev","undefined","handleCopy","navigator","clipboard","writeText","setTimeout","sendMessage","now","Date","newMsgs","push","m","concat","_j$data","res","fetch","method","headers","credentials","JSON","stringify","j","json","reply","data","label","startVoice","alert","SR","SpeechRecognition","webkitSpeechRecognition","rec","lang","interimResults","maxAlternatives","onresult","t","results","transcript","onend","onerror","onPickMedia","_e$target$files","f","files","url","URL","createObjectURL","showHero","length","minHeight","alignContent","objectFit","accept","type","shiftKey","onClick","gridAutoRows","map","rated","title","right","bottom","_c1","$RefreshReg$"],"sources":["/Users/khangtuan/Documents/eq_test/eq_test_frontend_v2/src/views/page-chat.js"],"sourcesContent":["import React, { useEffect, useRef, useState } from 'react'\nimport { Helmet } from 'react-helmet'\n\nconst IconPaperclip = (props) => (\n  <svg width=\"20\" height=\"20\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"1.7\" {...props}>\n    <path d=\"M21 11L10 22a5 5 0 0 1-7-7l11-11a3 3 0 0 1 4 4L8 19a1.5 1.5 0 0 1-2-2l9-9\" strokeLinecap=\"round\" strokeLinejoin=\"round\"/>\n  </svg>\n)\n\nconst IconMic = (props) => (\n  <svg width=\"18\" height=\"18\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"1.8\" {...props}>\n    <rect x=\"9\" y=\"2\" width=\"6\" height=\"12\" rx=\"3\" />\n    <path d=\"M5 11a7 7 0 0 0 14 0\" />\n    <path d=\"M12 19v3\" />\n  </svg>\n)\n/* ==== Icons & button style ==== */\nconst IconCopy = (props) => (\n  <svg width=\"18\" height=\"18\" viewBox=\"0 0 24 24\" fill=\"none\" {...props}>\n    <rect x=\"9\" y=\"9\" width=\"11\" height=\"11\" rx=\"2\" stroke=\"currentColor\" strokeWidth=\"1.7\"/>\n    <rect x=\"4\" y=\"4\" width=\"11\" height=\"11\" rx=\"2\" stroke=\"currentColor\" strokeWidth=\"1.7\"/>\n  </svg>\n)\n\nconst IconThumbUp = (props) => (\n  <svg width=\"18\" height=\"18\" viewBox=\"0 0 24 24\" fill=\"none\" {...props}>\n    <path d=\"M14 10V5a2 2 0 0 0-2-2l-3 7H5a2 2 0 0 0-2 2v7h10.3a3 3 0 0 0 2.9-2.1l2.1-6.2A2 2 0 0 0 16.4 9H14z\" stroke=\"currentColor\" strokeWidth=\"1.7\" strokeLinejoin=\"round\"/>\n  </svg>\n)\n\nconst IconThumbDown = (props) => (\n  <svg width=\"18\" height=\"18\" viewBox=\"0 0 24 24\" fill=\"none\" {...props}>\n    <path d=\"M10 14v5a2 2 0 0 0 2 2l3-7h4a2 2 0 0 0 2-2V5H10.7a3 3 0 0 0-2.9 2.1L5.7 13.3A2 2 0 0 0 7.6 16H10z\" stroke=\"currentColor\" strokeWidth=\"1.7\" strokeLinejoin=\"round\"/>\n  </svg>\n)\n\n/*  active: nền đen, chữ trắng, border đen  */\nconst actionBtnStyle = (active=false) => ({\n  background: active ? '#111827' : '#fff',\n  border: `1px solid ${active ? '#111827' : '#e5e7eb'}`,\n  color: active ? '#ffffff' : '#6b7280',\n  padding: '6px 10px',\n  borderRadius: 10,\n  display: 'inline-flex',\n  alignItems: 'center',\n  gap: 6,\n  cursor: 'pointer',\n  boxShadow: active ? '0 2px 10px rgba(0,0,0,0.15)' : '0 1px 4px rgba(0,0,0,0.04)',\n  userSelect: 'none',\n  transition: 'all .15s ease'\n})\n\n/* ==== Avatar ==== */\nconst Avatar = () => (\n  <div style={{ width: 64, height: 64, borderRadius: 12, background: '#e5e7eb', display: 'grid', placeItems: 'center' }}>\n    <span style={{ fontWeight: 700 }}>E</span>\n  </div>\n)\n\n/* ==== Message Bubble ==== */\nconst MessageBubble = ({ role, children, media }) => {\n  const isUser = role === 'user'\n  return (\n    <div style={{ display: 'grid', justifyItems: isUser ? 'end' : 'start' }}>\n      <div style={{\n        maxWidth: 720,\n        background: isUser ? '#111827' : '#ffffff',\n        color: isUser ? 'white' : '#111827',\n        border: isUser ? 'none' : '1px solid #e5e7eb',\n        padding: media ? 8 : 12,\n        borderRadius: 16,\n        boxShadow: isUser ? '0 4px 14px rgba(0,0,0,0.15)' : '0 4px 14px rgba(0,0,0,0.06)',\n        display: 'inline-block',\n        width: 'fit-content',\n        lineHeight: 1.6,\n      }}>\n        {media ? (\n          <img src={media} alt=\"attachment\" style={{ width: 260, borderRadius: 12 }} />\n        ) : (\n          <div style={{ whiteSpace: 'pre-wrap' }}>{children}</div>\n        )}\n      </div>\n    </div>\n  )\n}\n// Đặt trên cùng file, trước ChatPage\nconst AutoTextarea = React.forwardRef(function AutoTextarea(\n  {\n    value,\n    onChange,\n    onSend,              // gọi khi Enter (không kèm Ctrl/Cmd)\n    placeholder,\n    style\n  },\n  ref\n) {\n  const localRef = useRef(null)\n  const textareaRef = ref || localRef\n\n  const autoSize = () => {\n    const el = textareaRef.current\n    if (!el) return\n    el.style.height = 'auto'\n    // Giới hạn chiều cao tối đa để không chiếm màn hình\n    const max = 240 // px (tuỳ bạn)\n    const h = Math.min(el.scrollHeight, max)\n    el.style.height = h + 'px'\n    el.style.overflowY = el.scrollHeight > max ? 'auto' : 'hidden'\n  }\n\n  useEffect(() => { autoSize() }, [value])\n\n  const onKeyDown = (e) => {\n    if (e.key === 'Enter') {\n      if (e.metaKey || e.ctrlKey) {\n        // chèn \\n tại caret và không gửi\n        e.preventDefault()\n        const el = textareaRef.current\n        if (!el) return\n        const start = el.selectionStart\n        const end = el.selectionEnd\n        const next = value.slice(0, start) + '\\n' + value.slice(end)\n        onChange({ target: { value: next } })\n        // đặt lại caret sau \\n\n        requestAnimationFrame(() => {\n          el.selectionStart = el.selectionEnd = start + 1\n          autoSize()\n        })\n      } else {\n        // Enter thường => gửi\n        e.preventDefault()\n        onSend?.()\n      }\n    }\n  }\n\n  return (\n    <textarea\n      ref={textareaRef}\n      value={value}\n      onChange={(e) => { onChange(e); /* autosize lúc gõ */ requestAnimationFrame(autoSize) }}\n      onKeyDown={onKeyDown}\n      placeholder={placeholder}\n      rows={1}\n      style={{\n        flex: 1,\n        background: 'transparent',\n        color: '#111827',\n        border: 'none',\n        outline: 'none',\n        padding: '12px 10px',\n        fontSize: 18,\n        lineHeight: 1.6,\n        resize: 'none',\n        overflow: 'hidden',\n        whiteSpace: 'pre-wrap',\n        wordBreak: 'break-word',\n        ...style,\n      }}\n      aria-label=\"Message input\"\n    />\n  )\n})\n\n/* ==== Small toast ==== */\nconst Toast = ({ show, children }) => (\n  <div\n    aria-live=\"polite\"\n    style={{\n      position: 'absolute',\n      top: -100,\n      left: '50%',\n      transform: 'translateX(-50%)',\n      opacity: show ? 1 : 0,\n      transition: 'opacity .2s ease',\n      pointerEvents: 'none'\n    }}\n  >\n    <div style={{\n      background: '#111827', color: 'white',\n      padding: '6px 10px', borderRadius: 999,\n      fontSize: 12, boxShadow: '0 6px 18px rgba(0,0,0,.18)'\n    }}>\n      {children}\n    </div>\n  </div>\n)\n\n/* ==== Main Page ==== */\nconst ChatPage = () => {\n  const [messages, setMessages] = useState([])\n  const [text, setText] = useState('')\n  const [mediaPreview, setMediaPreview] = useState(null)\n  const [mediaFile, setMediaFile] = useState(null)\n  const [recording, setRecording] = useState(false)\n\n  const listRef = useRef(null)\n  const bottomRef = useRef(null)\n\n  const barRef = useRef(null)       // wrapper fixed\n  const barInnerRef = useRef(null)  // inner box được đo bằng ResizeObserver\n  const [bottomPad, setBottomPad] = useState(96);\n\n  // ratings & copy states\n  const [ratings, setRatings] = useState({})\n  const [copiedId, setCopiedId] = useState(null)\n\n  // Auto scroll khi có tin nhắn mới hoặc khi padding đáy thay đổi\n  useEffect(() => {\n    if (!barRef.current) return;\n  \n    const update = () => {\n      const h = barRef.current?.offsetHeight ?? 0;\n      setBottomPad(h + 16); // +16px breathing\n    };\n  \n    // đo động khi bar thay đổi kích thước\n    const ro = new ResizeObserver(update);\n    ro.observe(barRef.current);\n  \n    // nghe luôn sự kiện resize (desktop)\n    window.addEventListener('resize', update);\n    update();\n  \n    return () => {\n      ro.disconnect();\n      window.removeEventListener('resize', update);\n    };\n  }, []);\n\n  // Đo chiều cao thực của thanh input (kể cả margin) + safe-area\n  useEffect(() => {\n    const el = barInnerRef.current\n    if (!el) return\n\n    const compute = () => {\n      const rect = el.getBoundingClientRect()\n      const cs = window.getComputedStyle(el)\n      const margin = parseFloat(cs.marginTop) + parseFloat(cs.marginBottom)\n      const safe = Number(getComputedStyle(document.documentElement)\n        .getPropertyValue('--sat-safe-area-bottom') || 0)\n      setBottomPad(rect.height + margin + 8 + safe)\n    }\n\n    // fall back: đọc env(safe-area-inset-bottom) qua CSS var\n    const updateCSSVar = () => {\n      const div = document.createElement('div')\n      div.style.cssText = 'position:fixed;bottom:0;left:0;right:0;padding-bottom:env(safe-area-inset-bottom);visibility:hidden;'\n      document.body.appendChild(div)\n      const pb = parseFloat(getComputedStyle(div).paddingBottom) || 0\n      document.documentElement.style.setProperty('--sat-safe-area-bottom', pb)\n      document.body.removeChild(div)\n    }\n\n    updateCSSVar()\n    compute()\n    const ro = new ResizeObserver(compute)\n    ro.observe(el)\n    window.addEventListener('resize', compute)\n\n    return () => {\n      ro.disconnect()\n      window.removeEventListener('resize', compute)\n    }\n  }, [])\n\n  const handleRate = (id, val) => {\n    setRatings(prev => ({ ...prev, [id]: prev[id] === val ? undefined : val }))\n  }\n\n  const handleCopy = async (id, text) => {\n    if (!text) return\n    try {\n      await navigator.clipboard.writeText(text)\n      setCopiedId(id)\n      setTimeout(() => setCopiedId(null), 1200)\n    } catch {}\n  }\n\n  const sendMessage = async () => {\n    if (!text && !mediaPreview) return\n    const now = Date.now()\n    const newMsgs = []\n    if (mediaPreview) newMsgs.push({ id: now, role: 'user', media: mediaPreview })\n    if (text) newMsgs.push({ id: now + 1, role: 'user', text })\n    setMessages((m) => m.concat(newMsgs))\n    setText('')\n    setMediaPreview(null)\n    setMediaFile(null)\n    try {\n      const res = await fetch('/api/v1/analysis/analyze-sentiment', {\n        method: 'POST',\n        headers: { 'Content-Type': 'application/json' },\n        credentials: 'include',\n        body: JSON.stringify({ text: text || '[media]' }),\n      })\n      const j = await res.json()\n      const reply = j?.data?.label\n        ? `Chào bạn! Hình như chúng ta đã chào nhau rồi nhỉ. Bạn muốn hỏi thêm gì về Emostagram? (Sentiment: ${j.data.label})`\n        : 'Chào bạn! Hình như chúng ta đã chào nhau rồi nhỉ. Bạn muốn hỏi thêm gì về Emostagram?'\n      setMessages((m) => m.concat({ id: Date.now() + 2, role: 'assistant', text: reply }))\n    } catch {\n      setMessages((m) => m.concat({ id: Date.now() + 2, role: 'assistant', text: 'Sorry, something went wrong.' }))\n    }\n  }\n\n  // Voice input\n  const startVoice = () => {\n    if (!('webkitSpeechRecognition' in window) && !('SpeechRecognition' in window)) {\n      alert('Voice input not supported in this browser')\n      return\n    }\n    const SR = window.SpeechRecognition || window.webkitSpeechRecognition\n    const rec = new SR()\n    rec.lang = 'vi-VN'\n    rec.interimResults = false\n    rec.maxAlternatives = 1\n    setRecording(true)\n    rec.onresult = (e) => {\n      const t = e.results[0][0].transcript\n      setText((prev) => (prev ? prev + ' ' + t : t))\n    }\n    rec.onend = () => setRecording(false)\n    rec.onerror = () => setRecording(false)\n    rec.start()\n  }\n\n  const onPickMedia = (e) => {\n    const f = e.target.files?.[0]\n    if (!f) return\n    const url = URL.createObjectURL(f)\n    setMediaPreview(url)\n    setMediaFile(f)\n  }\n\n  const showHero = messages.length === 0\n\n  return (\n    <main style={{ minHeight: '100vh', background: '#f8fafc', color: '#111827' }}>\n      <Helmet><title>Chat - Emostagram</title></Helmet>\n      <div style={{ maxWidth: 980, margin: '0 auto', padding: '16px 16px 0 16px', display: 'grid', gap: 16 }}>\n        {showHero ? (\n          <div style={{ minHeight: '70vh', display: 'grid', alignContent: 'center', justifyItems: 'center', gap: 20 }}>\n            <Avatar />\n            <h1 style={{ marginTop: 8, fontSize: 36, fontWeight: 700 }}>Emostagram</h1>\n            <div style={{ width: '100%', display: 'grid', justifyItems: 'center', gap: 12 }}>\n              {mediaPreview && (\n                <img src={mediaPreview} alt=\"preview\" style={{ width: 72, height: 72, objectFit: 'cover', borderRadius: 14, boxShadow: '0 8px 26px rgba(0,0,0,0.12)' }} />\n              )}\n              <div style={{\n                width: 'min(92vw, 760px)',\n                height: 64,\n                background: '#ffffff',\n                border: '1px solid #e5e7eb',\n                borderRadius: 18,\n                boxShadow: '0 12px 40px rgba(0,0,0,0.06)',\n                display: 'flex',\n                alignItems: 'center',\n                padding: '0 10px',\n                gap: 8\n              }}>\n                <label style={{ cursor: 'pointer', padding: 8, display: 'grid', placeItems: 'center' }}>\n                  📎\n                  <input accept=\"*/*\" type=\"file\" style={{ display: 'none' }} onChange={onPickMedia} />\n                </label>\n                <AutoTextarea\n                  value={text}\n                  onChange={(e) => setText(e.target.value)}\n                  onSend={sendMessage}\n                  onKeyDown={(e) => {\n                    if (e.key === 'Enter') {\n                      if (e.shiftKey) {\n                        // xuống dòng, giữ mặc định\n                        return\n                      } else {\n                        // gửi\n                        e.preventDefault()\n                        sendMessage()\n                      }\n                    }\n                  }}\n                  placeholder=\"What do you want to know?\"\n                  style={{ flex: 1, background: 'transparent', color: '#111827', border: 'none', outline: 'none', padding: '12px 10px', fontSize: 18 }}\n                />\n                <button onClick={startVoice} aria-label=\"voice\" style={{ width: 42, height: 42, borderRadius: 999, background: '#111827', color: 'white', border: 'none', display: 'grid', placeItems: 'center' }}>\n                  {recording ? '🎙️' : '🎤'}\n                </button>\n              </div>\n            </div>\n          </div>\n        ) : (\n          <>\n            {/* List messages: chừa chỗ bằng paddingBottom */}\n            <div\n              ref={listRef}\n              style={{\n                display: 'grid',\n                gap: 6,\n                padding: '0 8px',\n                alignItems: 'start',\n                gridAutoRows: 'max-content',\n                margin: 0,\n                // paddingBottom: bottomPad\n                paddingBottom: `calc(${bottomPad}px + env(safe-area-inset-bottom, 0px))`,\n\n              }}\n            >\n              {messages.map((m) => {\n                const rated = ratings[m.id]\n                return (\n                  <div key={m.id} style={{ display: 'grid', gap: 6 }}>\n                    <MessageBubble role={m.role} media={m.media}>{m.text}</MessageBubble>\n\n                    {m.role === 'assistant' && (\n                      <div style={{ position: 'relative' }}>\n                        <Toast show={copiedId === m.id}>Copy thành công</Toast>\n\n                        <div style={{ display: 'flex', gap: 8 }}>\n                          <button\n                            aria-label=\"copy\"\n                            onClick={() => handleCopy(m.id, m.text)}\n                            style={actionBtnStyle(copiedId === m.id)}\n                          >\n                            <IconCopy />\n                          </button>\n\n                          {(rated === undefined || rated === 'up') && (\n                            <button\n                              aria-label=\"like\"\n                              onClick={() => handleRate(m.id, 'up')}\n                              style={actionBtnStyle(rated === 'up')}\n                              title=\"Like\"\n                            >\n                              <IconThumbUp />\n                            </button>\n                          )}\n\n                          {(rated === undefined || rated === 'down') && (\n                            <button\n                              aria-label=\"dislike\"\n                              onClick={() => handleRate(m.id, 'down')}\n                              style={actionBtnStyle(rated === 'down')}\n                              title=\"Dislike\"\n                            >\n                              <IconThumbDown />\n                            </button>\n                          )}\n                        </div>\n                      </div>\n                    )}\n                  </div>\n                )\n              })}\n              {/* sentinel siêu nhỏ để scrollIntoView */}\n              <div ref={bottomRef} style={{ height: 1 }} />\n            </div>\n\n            {/* Bottom input bar */}\n            <div\n              ref={barRef}\n              style={{\n                position: 'fixed',\n                left: 0,\n                right: 0,\n                bottom: 0,\n                paddingBottom: 'env(safe-area-inset-bottom)'\n              }}\n            >\n              <div\n                ref={barInnerRef}\n                style={{\n                  maxWidth: 980,\n                  margin: '12px auto',\n                  position: 'relative'\n                }}\n              >\n                {mediaPreview && (\n                  <img\n                    src={mediaPreview}\n                    alt=\"preview\"\n                    style={{\n                      position: 'absolute',\n                      bottom: '100%',\n                      left: 0,\n                      width: 56,\n                      height: 56,\n                      objectFit: 'cover',\n                      borderRadius: 12,\n                      boxShadow: '0 6px 20px rgba(0,0,0,0.12)',\n                      marginBottom: 8\n                    }}\n                  />\n                )}\n                <div style={{\n                  display: 'flex',\n                  alignItems: 'center',\n                  gap: 8,\n                  background: '#ffffff',\n                  border: '1px solid #e5e7eb',\n                  borderRadius: 16,\n                  padding: 8\n                }}>\n                  <label style={{ cursor: 'pointer', padding: 8 }}>\n                    📎\n                    <input accept=\"*/*\" type=\"file\" style={{ display: 'none' }} onChange={onPickMedia} />\n                  </label>\n                  <AutoTextarea\n                    value={text}\n                    onChange={(e) => setText(e.target.value)}\n                    onSend={sendMessage}\n                    onKeyDown={(e) => {\n                      if (e.key === 'Enter') {\n                        if (e.shiftKey) {\n                          // xuống dòng, giữ mặc định\n                          return\n                        } else {\n                          // gửi\n                          e.preventDefault()\n                          sendMessage()\n                        }\n                      }\n                    }}\n                    placeholder=\"What do you want to know?\"\n                    style={{ flex: 1, background: 'transparent', color: '#111827', border: 'none', outline: 'none', padding: '12px 10px', fontSize: 18 }}\n                  />\n                  <button onClick={startVoice} aria-label=\"voice\" style={{ width: 42, height: 42, borderRadius: 999, background: '#111827', color: 'white', border: 'none', display: 'grid', placeItems: 'center' }}>\n                    {recording ? '🎙️' : '🎤'}\n                  </button>\n                </div>\n              </div>\n            </div>\n          </>\n        )}\n      </div>\n    </main>\n  )\n}\n\nexport default ChatPage\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}