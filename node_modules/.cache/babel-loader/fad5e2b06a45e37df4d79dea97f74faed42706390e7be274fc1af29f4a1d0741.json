{"ast":null,"code":"var _jsxFileName = \"/Users/khangtuan/Documents/eq_test/eq_test_frontend_v2/src/components/AudioBubble.jsx\",\n  _s = $RefreshSig$();\n// AudioBubble.jsx\nimport React, { useEffect, useRef, useState } from 'react';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nexport default function AudioBubble({\n  src,\n  duration,\n  peaks\n}) {\n  _s();\n  const audioRef = useRef(null);\n  const canvasRef = useRef(null);\n  const [playing, setPlaying] = useState(false);\n  const [progress, setProgress] = useState(0); // 0..1\n\n  useEffect(() => {\n    const a = audioRef.current;\n    if (!a) return;\n    const t = () => setProgress(a.currentTime / (a.duration || duration || 1));\n    a.addEventListener('timeupdate', t);\n    a.addEventListener('ended', () => setPlaying(false));\n    return () => {\n      a.removeEventListener('timeupdate', t);\n    };\n  }, [duration]);\n  useEffect(() => {\n    draw(peaks, progress);\n  }, [peaks, progress]);\n  const draw = (peaks, prog) => {\n    const c = canvasRef.current;\n    if (!c) return;\n    const ctx = c.getContext('2d');\n    const w = c.width,\n      h = c.height;\n    ctx.clearRect(0, 0, w, h);\n    const mid = h / 2;\n    const n = peaks.length;\n    const barW = w / n;\n    for (let i = 0; i < n; i++) {\n      const {\n        min,\n        max\n      } = peaks[i];\n      const y1 = mid + min * mid;\n      const y2 = mid + max * mid;\n      const x = i * barW;\n      ctx.fillStyle = i / n <= prog ? '#ffffff' : 'rgba(255,255,255,.7)';\n      const bw = Math.max(2, barW * 0.7);\n      ctx.fillRect(x + (barW - bw) / 2, y1, bw, y2 - y1);\n    }\n  };\n  const toggle = () => {\n    const a = audioRef.current;\n    if (!a) return;\n    if (playing) {\n      a.pause();\n      setPlaying(false);\n    } else {\n      a.play();\n      setPlaying(true);\n    }\n  };\n  const onSeek = e => {\n    const rect = e.currentTarget.getBoundingClientRect();\n    const p = Math.min(1, Math.max(0, (e.clientX - rect.left) / rect.width));\n    const a = audioRef.current;\n    const dur = a.duration || duration || 1;\n    a.currentTime = dur * p;\n    setProgress(a.currentTime / dur);\n  };\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    style: {\n      display: 'flex',\n      alignItems: 'center',\n      gap: 12,\n      background: '#2563eb',\n      color: '#fff',\n      borderRadius: 16,\n      padding: '10px 12px',\n      minWidth: 260,\n      maxWidth: 420\n    },\n    children: [/*#__PURE__*/_jsxDEV(\"button\", {\n      onClick: toggle,\n      \"aria-label\": playing ? 'Pause' : 'Play',\n      style: {\n        width: 36,\n        height: 36,\n        borderRadius: '50%',\n        background: '#fff',\n        color: '#2563eb',\n        border: 'none',\n        cursor: 'pointer',\n        display: 'grid',\n        placeItems: 'center',\n        fontWeight: 700\n      },\n      children: playing ? '❚❚' : '►'\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 62,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      onClick: onSeek,\n      style: {\n        flex: 1,\n        cursor: 'pointer'\n      },\n      children: /*#__PURE__*/_jsxDEV(\"canvas\", {\n        ref: canvasRef,\n        width: 240,\n        height: 36,\n        style: {\n          width: '100%',\n          height: 36,\n          display: 'block'\n        }\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 68,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 67,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n      style: {\n        background: '#fff',\n        color: '#2563eb',\n        padding: '3px 8px',\n        borderRadius: 999,\n        fontVariantNumeric: 'tabular-nums'\n      },\n      children: [format(progress * (duration || 0) || 0), \"/\", format(duration || 0)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 71,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"audio\", {\n      ref: audioRef,\n      src: src,\n      preload: \"metadata\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 75,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 57,\n    columnNumber: 5\n  }, this);\n}\n_s(AudioBubble, \"ZrH2vF0+GBzPQUjvfRUyAixpjdM=\");\n_c = AudioBubble;\nconst format = s => {\n  const mm = String(Math.floor(s / 60)).padStart(1, '0');\n  const ss = String(Math.floor(s % 60)).padStart(2, '0');\n  return `${mm}:${ss}`;\n};\nvar _c;\n$RefreshReg$(_c, \"AudioBubble\");","map":{"version":3,"names":["React","useEffect","useRef","useState","jsxDEV","_jsxDEV","AudioBubble","src","duration","peaks","_s","audioRef","canvasRef","playing","setPlaying","progress","setProgress","a","current","t","currentTime","addEventListener","removeEventListener","draw","prog","c","ctx","getContext","w","width","h","height","clearRect","mid","n","length","barW","i","min","max","y1","y2","x","fillStyle","bw","Math","fillRect","toggle","pause","play","onSeek","e","rect","currentTarget","getBoundingClientRect","p","clientX","left","dur","style","display","alignItems","gap","background","color","borderRadius","padding","minWidth","maxWidth","children","onClick","border","cursor","placeItems","fontWeight","fileName","_jsxFileName","lineNumber","columnNumber","flex","ref","fontVariantNumeric","format","preload","_c","s","mm","String","floor","padStart","ss","$RefreshReg$"],"sources":["/Users/khangtuan/Documents/eq_test/eq_test_frontend_v2/src/components/AudioBubble.jsx"],"sourcesContent":["// AudioBubble.jsx\nimport React, { useEffect, useRef, useState } from 'react'\n\nexport default function AudioBubble({ src, duration, peaks }) {\n  const audioRef = useRef(null)\n  const canvasRef = useRef(null)\n  const [playing, setPlaying] = useState(false)\n  const [progress, setProgress] = useState(0) // 0..1\n\n  useEffect(() => {\n    const a = audioRef.current\n    if (!a) return\n    const t = () => setProgress(a.currentTime / (a.duration || duration || 1))\n    a.addEventListener('timeupdate', t)\n    a.addEventListener('ended', () => setPlaying(false))\n    return () => { a.removeEventListener('timeupdate', t) }\n  }, [duration])\n\n  useEffect(() => { draw(peaks, progress) }, [peaks, progress])\n\n  const draw = (peaks, prog) => {\n    const c = canvasRef.current; if (!c) return\n    const ctx = c.getContext('2d')\n    const w = c.width, h = c.height\n    ctx.clearRect(0,0,w,h)\n    const mid = h/2\n    const n = peaks.length\n    const barW = w / n\n    for (let i=0;i<n;i++){\n      const {min, max} = peaks[i]\n      const y1 = mid + min*mid\n      const y2 = mid + max*mid\n      const x = i * barW\n      ctx.fillStyle = i/n <= prog ? '#ffffff' : 'rgba(255,255,255,.7)'\n      const bw = Math.max(2, barW*0.7)\n      ctx.fillRect(x+(barW-bw)/2, y1, bw, y2-y1)\n    }\n  }\n\n  const toggle = () => {\n    const a = audioRef.current\n    if (!a) return\n    if (playing) { a.pause(); setPlaying(false) }\n    else { a.play(); setPlaying(true) }\n  }\n\n  const onSeek = (e) => {\n    const rect = e.currentTarget.getBoundingClientRect()\n    const p = Math.min(1, Math.max(0, (e.clientX - rect.left)/rect.width))\n    const a = audioRef.current\n    const dur = a.duration || duration || 1\n    a.currentTime = dur * p\n    setProgress(a.currentTime/dur)\n  }\n\n  return (\n    <div style={{\n      display:'flex', alignItems:'center', gap:12,\n      background:'#2563eb', color:'#fff',\n      borderRadius:16, padding:'10px 12px', minWidth:260, maxWidth:420\n    }}>\n      <button onClick={toggle} aria-label={playing?'Pause':'Play'}\n        style={{ width:36, height:36, borderRadius:'50%', background:'#fff', color:'#2563eb', border:'none', cursor:'pointer', display:'grid', placeItems:'center', fontWeight:700 }}>\n        {playing ? '❚❚' : '►'}\n      </button>\n\n      <div onClick={onSeek} style={{ flex:1, cursor:'pointer' }}>\n        <canvas ref={canvasRef} width={240} height={36} style={{ width:'100%', height:36, display:'block' }} />\n      </div>\n\n      <span style={{ background:'#fff', color:'#2563eb', padding:'3px 8px', borderRadius:999, fontVariantNumeric:'tabular-nums' }}>\n        {format(progress * (duration || 0) || 0)}/{format(duration || 0)}\n      </span>\n\n      <audio ref={audioRef} src={src} preload=\"metadata\" />\n    </div>\n  )\n}\n\nconst format = (s) => {\n  const mm = String(Math.floor(s/60)).padStart(1,'0')\n  const ss = String(Math.floor(s%60)).padStart(2,'0')\n  return `${mm}:${ss}`\n}\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}